<div class="table-container">
  <div class="region-container">
    <h2 style="float: left; width: 50%">Service Outage</h2>
    <ng-select
      style="float: right; width: 50%"
      [clearable]="false"
      [searchable]="false"
      [(ngModel)]="userRegion"
      placeholder="REGION"
      (change)="onRegionChange($event)"
    >
      <ng-option *ngFor="let region of regions" [value]="region.name">{{
        region.name
      }}</ng-option>
    </ng-select>
  </div>

  <ngx-datatable
    #myTable
    class="material expandable"
    [headerHeight]="50"
    [footerHeight]="150"
    [rowHeight]="50"
    [rows]="rows"
  >
    <ngx-datatable-row-detail
      #myDetailRow
      [rowHeight]="250"
      (toggle)="onDetailToggle($event)"
    >
      <ng-template
        let-row="row"
        let-expanded="expanded"
        ngx-datatable-row-detail-template
      >
        <ngx-datatable
          [headerHeight]="0"
          [footerHeight]="0"
          rowHeight="auto"
          [rows]="getSubTableRows(row)"
        >
          <ngx-datatable-column [width]="50" [sortable]="false">
          </ngx-datatable-column>

          <ngx-datatable-column prop="apiName" name="API" [width]="250">
            <ng-template
              let-row="row"
              let-value="value"
              ngx-datatable-cell-template
            >
              <span>{{ value }} API </span>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column prop="status" name="STATUS" [width]="250">
            <ng-template
              let-row="row"
              let-value="value"
              ngx-datatable-cell-template
            >
              <img
                *ngIf="value"
                class="status-image"
                src="{{ getStatusImage(value) }}"
              />
              <span>{{ value }}</span>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column prop="upTime" name="UP TIME" [width]="100">
            <ng-template let-value="value" ngx-datatable-cell-template>
              <span>{{ value }}</span>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column
            prop="avgResponseTime"
            name="AVG. RESPONSE"
            [width]="150"
          >
            <ng-template
              let-row="row"
              let-value="value"
              ngx-datatable-cell-template
            >
              <span>{{ value }}</span>
            </ng-template>
          </ngx-datatable-column>
        </ngx-datatable>
      </ng-template>
    </ngx-datatable-row-detail>

    <ngx-datatable-column
      [width]="50"
      [resizeable]="false"
      [sortable]="false"
      [draggable]="false"
      [canAutoResize]="false"
    >
      <ng-template
        let-row="row"
        let-expanded="expanded"
        ngx-datatable-cell-template
      >
        <img
          *ngIf="!expanded && isSubApisPresent(row)"
          src="/assets/images/down.svg"
          height="25px"
          class="src"
          (click)="toggleExpandRow(row)"
        />
        <img
          *ngIf="expanded && isSubApisPresent(row)"
          src="/assets/images/up.svg"
          height="25px"
          class="src"
          (click)="toggleExpandRow(row)"
        />
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column prop="apiName" name="API" [width]="250">
      <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
        <span>{{ value }} API </span>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column prop="status" name="STATUS" [width]="250">
      <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
        <img
          *ngIf="value"
          class="status-image"
          src="{{ getStatusImage(value) }}"
        />
        <span>{{ value }}</span>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column prop="upTime" name="UP TIME" [width]="100">
      <ng-template let-value="value" ngx-datatable-cell-template>
        <span>{{ value }}</span>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-column
      prop="avgResponseTime"
      name="AVG. RESPONSE"
      [width]="150"
    >
      <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
        <span>{{ value }}</span>
      </ng-template>
    </ngx-datatable-column>

    <ngx-datatable-footer>
      <ng-template ngx-datatable-footer-template>
        <div style="padding: 20px 20px">
          <strong>DEFINITIONS</strong>
          <p>Outage</p>
          <p>Incident</p>
          <p>Operational</p>
        </div>
      </ng-template>
    </ngx-datatable-footer>
  </ngx-datatable>
</div>
